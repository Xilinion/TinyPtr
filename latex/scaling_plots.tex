\section{Scaling Analysis}

% Function to map case numbers to descriptive names
\newcommand{\getCaseName}[1]{%
    \ifnum#1=1 Insertion\fi%
    \ifnum#1=3 Deletion\fi%
    \ifnum#1=6 Positive Query\fi%
    \ifnum#1=7 Negative Query\fi%
}

% Shared legend above all graphs
\begin{figure}[p]
    \centering
    \begin{tikzpicture}
        \begin{axis}[
            width=12cm,
            height=2cm,
            hide axis,
            legend entries={Cuckoo, Iceberg, Junction, TPHT, Blast},
            legend columns=5,
            legend style={font=\small},
            legend to name={scaling-legend}
        ]
        \addplot[mark=o, color=exp1, thick] coordinates {(0,0)};
        \addplot[mark=square, color=exp2, thick] coordinates {(0,0)};
        \addplot[mark=triangle, color=exp3, thick] coordinates {(0,0)};
        \addplot[mark=diamond, color=exp4, thick] coordinates {(0,0)};
        \addplot[mark=pentagon, color=poisson, thick] coordinates {(0,0)};
        \end{axis}
    \end{tikzpicture}
    \vspace{0.5cm}
\end{figure}

\begin{figure}[p]
    \centering

    % Case 1
    \begin{subfigure}[b]{0.48\textwidth}
        \centering
        \begin{tikzpicture}
            \begin{axis}[
                width=6cm,
                height=4cm,
                xlabel={Thread Number},
                ylabel={Throughput (M ops/s)},
                xmode=log,
                log basis x=2,
                xmin=0.5,
                xmax=64,
                ymin=0,
                ymax=400,
                xtick={1,2,4,8,16,32},
                grid=major,
                grid style={gray!30},
                tick label style={font=\small},
                label style={font=\small},
                title={\getCaseName{1}},
                title style={font=\small},
                scaled ticks=true,
                tick label style={/pgf/number format/fixed,/pgf/number format/precision=1}
            ]

            % Cuckoo (object_id=6)
            \addplot[
                mark=o,
                mark size=2pt,
                color=exp1,
                thick,
                smooth
            ] table[
                x=thread_num,
                y expr=\thisrow{throughput (ops/s)}/1000000,
                restrict expr to domain={\thisrow{case_id}}{1:1},
                restrict expr to domain={\thisrow{object_id}}{6:6}
            ] {\scalingdata};

            % Iceberg (object_id=7)
            \addplot[
                mark=square,
                mark size=2pt,
                color=exp2,
                thick,
                smooth
            ] table[
                x=thread_num,
                y expr=\thisrow{throughput (ops/s)}/1000000,
                restrict expr to domain={\thisrow{case_id}}{1:1},
                restrict expr to domain={\thisrow{object_id}}{7:7}
            ] {\scalingdata};

            % Junction (object_id=15)
            \addplot[
                mark=triangle,
                mark size=2pt,
                color=exp3,
                thick,
                smooth
            ] table[
                x=thread_num,
                y expr=\thisrow{throughput (ops/s)}/1000000,
                restrict expr to domain={\thisrow{case_id}}{1:1},
                restrict expr to domain={\thisrow{object_id}}{15:15}
            ] {\scalingdata};

            % TPHT (object_id=17)
            \addplot[
                mark=diamond,
                mark size=2pt,
                color=exp4,
                thick,
                smooth
            ] table[
                x=thread_num,
                y expr=\thisrow{throughput (ops/s)}/1000000,
                restrict expr to domain={\thisrow{case_id}}{1:1},
                restrict expr to domain={\thisrow{object_id}}{17:17}
            ] {\scalingdata};

            % Blast (object_id=20)
            \addplot[
                mark=pentagon,
                mark size=2pt,
                color=poisson,
                thick,
                smooth
            ] table[
                x=thread_num,
                y expr=\thisrow{throughput (ops/s)}/1000000,
                restrict expr to domain={\thisrow{case_id}}{1:1},
                restrict expr to domain={\thisrow{object_id}}{20:20}
            ] {\scalingdata};

            \end{axis}
        \end{tikzpicture}
        \caption{\getCaseName{1}}
    \end{subfigure}
    \hfill
    % Case 3
    \begin{subfigure}[b]{0.48\textwidth}
        \centering
        \begin{tikzpicture}
            \begin{axis}[
                width=6cm,
                height=4cm,
                xlabel={Thread Number},
                ylabel={Throughput (M ops/s)},
                xmode=log,
                log basis x=2,
                xmin=0.5,
                xmax=64,
                ymin=0,
                ymax=400,
                xtick={1,2,4,8,16,32},
                grid=major,
                grid style={gray!30},
                tick label style={font=\small},
                label style={font=\small},
                title={\getCaseName{3}},
                title style={font=\small},
                scaled ticks=true,
                tick label style={/pgf/number format/fixed,/pgf/number format/precision=1}
            ]

            % Cuckoo (object_id=6)
            \addplot[
                mark=o,
                mark size=2pt,
                color=exp1,
                thick,
                smooth
            ] table[
                x=thread_num,
                y expr=\thisrow{throughput (ops/s)}/1000000,
                restrict expr to domain={\thisrow{case_id}}{3:3},
                restrict expr to domain={\thisrow{object_id}}{6:6}
            ] {\scalingdata};

            % Iceberg (object_id=7)
            \addplot[
                mark=square,
                mark size=2pt,
                color=exp2,
                thick,
                smooth
            ] table[
                x=thread_num,
                y expr=\thisrow{throughput (ops/s)}/1000000,
                restrict expr to domain={\thisrow{case_id}}{3:3},
                restrict expr to domain={\thisrow{object_id}}{7:7}
            ] {\scalingdata};

            % Junction (object_id=15)
            \addplot[
                mark=triangle,
                mark size=2pt,
                color=exp3,
                thick,
                smooth
            ] table[
                x=thread_num,
                y expr=\thisrow{throughput (ops/s)}/1000000,
                restrict expr to domain={\thisrow{case_id}}{3:3},
                restrict expr to domain={\thisrow{object_id}}{15:15}
            ] {\scalingdata};

            % TPHT (object_id=17)
            \addplot[
                mark=diamond,
                mark size=2pt,
                color=exp4,
                thick,
                smooth
            ] table[
                x=thread_num,
                y expr=\thisrow{throughput (ops/s)}/1000000,
                restrict expr to domain={\thisrow{case_id}}{3:3},
                restrict expr to domain={\thisrow{object_id}}{17:17}
            ] {\scalingdata};

            % Blast (object_id=20)
            \addplot[
                mark=pentagon,
                mark size=2pt,
                color=poisson,
                thick,
                smooth
            ] table[
                x=thread_num,
                y expr=\thisrow{throughput (ops/s)}/1000000,
                restrict expr to domain={\thisrow{case_id}}{3:3},
                restrict expr to domain={\thisrow{object_id}}{20:20}
            ] {\scalingdata};

            \end{axis}
        \end{tikzpicture}
        \caption{\getCaseName{3}}
    \end{subfigure}

    % Case 6
    \begin{subfigure}[b]{0.48\textwidth}
        \centering
        \begin{tikzpicture}
            \begin{axis}[
                width=6cm,
                height=4cm,
                xlabel={Thread Number},
                ylabel={Throughput (M ops/s)},
                xmode=log,
                log basis x=2,
                xmin=0.5,
                xmax=64,
                ymin=0,
                ymax=400,
                xtick={1,2,4,8,16,32},
                grid=major,
                grid style={gray!30},
                tick label style={font=\small},
                label style={font=\small},
                title={\getCaseName{6}},
                title style={font=\small},
                scaled ticks=true,
                tick label style={/pgf/number format/fixed,/pgf/number format/precision=1}
            ]

            % Cuckoo (object_id=6)
            \addplot[
                mark=o,
                mark size=2pt,
                color=exp1,
                thick,
                smooth
            ] table[
                x=thread_num,
                y expr=\thisrow{throughput (ops/s)}/1000000,
                restrict expr to domain={\thisrow{case_id}}{6:6},
                restrict expr to domain={\thisrow{object_id}}{6:6}
            ] {\scalingdata};

            % Iceberg (object_id=7)
            \addplot[
                mark=square,
                mark size=2pt,
                color=exp2,
                thick,
                smooth
            ] table[
                x=thread_num,
                y expr=\thisrow{throughput (ops/s)}/1000000,
                restrict expr to domain={\thisrow{case_id}}{6:6},
                restrict expr to domain={\thisrow{object_id}}{7:7}
            ] {\scalingdata};

            % Junction (object_id=15)
            \addplot[
                mark=triangle,
                mark size=2pt,
                color=exp3,
                thick,
                smooth
            ] table[
                x=thread_num,
                y expr=\thisrow{throughput (ops/s)}/1000000,
                restrict expr to domain={\thisrow{case_id}}{6:6},
                restrict expr to domain={\thisrow{object_id}}{15:15}
            ] {\scalingdata};

            % TPHT (object_id=17)
            \addplot[
                mark=diamond,
                mark size=2pt,
                color=exp4,
                thick,
                smooth
            ] table[
                x=thread_num,
                y expr=\thisrow{throughput (ops/s)}/1000000,
                restrict expr to domain={\thisrow{case_id}}{6:6},
                restrict expr to domain={\thisrow{object_id}}{17:17}
            ] {\scalingdata};

            % Blast (object_id=20)
            \addplot[
                mark=pentagon,
                mark size=2pt,
                color=poisson,
                thick,
                smooth
            ] table[
                x=thread_num,
                y expr=\thisrow{throughput (ops/s)}/1000000,
                restrict expr to domain={\thisrow{case_id}}{6:6},
                restrict expr to domain={\thisrow{object_id}}{20:20}
            ] {\scalingdata};

            \end{axis}
        \end{tikzpicture}
        \caption{\getCaseName{6}}
    \end{subfigure}
    \hfill
    % Case 7
    \begin{subfigure}[b]{0.48\textwidth}
        \centering
        \begin{tikzpicture}
            \begin{axis}[
                width=6cm,
                height=4cm,
                xlabel={Thread Number},
                ylabel={Throughput (M ops/s)},
                xmode=log,
                log basis x=2,
                xmin=0.5,
                xmax=64,
                ymin=0,
                ymax=400,
                xtick={1,2,4,8,16,32},
                grid=major,
                grid style={gray!30},
                tick label style={font=\small},
                label style={font=\small},
                title={\getCaseName{7}},
                title style={font=\small},
                scaled ticks=true,
                tick label style={/pgf/number format/fixed,/pgf/number format/precision=1}
            ]

            % Cuckoo (object_id=6)
            \addplot[
                mark=o,
                mark size=2pt,
                color=exp1,
                thick,
                smooth
            ] table[
                x=thread_num,
                y expr=\thisrow{throughput (ops/s)}/1000000,
                restrict expr to domain={\thisrow{case_id}}{7:7},
                restrict expr to domain={\thisrow{object_id}}{6:6}
            ] {\scalingdata};

            % Iceberg (object_id=7)
            \addplot[
                mark=square,
                mark size=2pt,
                color=exp2,
                thick,
                smooth
            ] table[
                x=thread_num,
                y expr=\thisrow{throughput (ops/s)}/1000000,
                restrict expr to domain={\thisrow{case_id}}{7:7},
                restrict expr to domain={\thisrow{object_id}}{7:7}
            ] {\scalingdata};

            % Junction (object_id=15)
            \addplot[
                mark=triangle,
                mark size=2pt,
                color=exp3,
                thick,
                smooth
            ] table[
                x=thread_num,
                y expr=\thisrow{throughput (ops/s)}/1000000,
                restrict expr to domain={\thisrow{case_id}}{7:7},
                restrict expr to domain={\thisrow{object_id}}{15:15}
            ] {\scalingdata};

            % TPHT (object_id=17)
            \addplot[
                mark=diamond,
                mark size=2pt,
                color=exp4,
                thick,
                smooth
            ] table[
                x=thread_num,
                y expr=\thisrow{throughput (ops/s)}/1000000,
                restrict expr to domain={\thisrow{case_id}}{7:7},
                restrict expr to domain={\thisrow{object_id}}{17:17}
            ] {\scalingdata};

            % Blast (object_id=20)
            \addplot[
                mark=pentagon,
                mark size=2pt,
                color=poisson,
                thick,
                smooth
            ] table[
                x=thread_num,
                y expr=\thisrow{throughput (ops/s)}/1000000,
                restrict expr to domain={\thisrow{case_id}}{7:7},
                restrict expr to domain={\thisrow{object_id}}{20:20}
            ] {\scalingdata};

            \end{axis}
        \end{tikzpicture}
        \caption{\getCaseName{7}}
    \end{subfigure}

    \caption{Scaling Analysis for different hash table implementations across various operations. Each subfigure shows throughput scaling with thread count for a specific operation type.}
    \label{fig:scaling_analysis}
\end{figure} 